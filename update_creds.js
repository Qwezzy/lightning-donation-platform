import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

const tlsHex = '2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434d544343416469674177494241674951654f4e4e457037774233517557466b376e4c62514644414b42676771686b6a4f50515144416a41764d5238770a485159445651514b45785a73626d5167595856306232646c626d56795958526c5a43426a5a584a304d517777436759445651514445774e4f523038774868634e0a4d6a59774d6a45794d5441774d7a51315768634e4d6a63774e4441354d5441774d7a5131576a41764d523877485159445651514b45785a73626d5167595856300a6232646c626d56795958526c5a43426a5a584a304d517777436759445651514445774e4f523038775754415442676371686b6a4f5051494242676771686b6a4f0a50514d4242774e434141526c6f434c616a4f59614d6e6b444b304651424371504f42524f446f42703337317957323334423057454353476771475756374f68300a564a4e494d4b543545335159702f616d3833714a754b786f5a567766683178636f3448564d4948534d41344741315564447745422f77514541774943704441540a42674e56485355454444414b4267677242674546425163444154415042674e5648524d4241663845425441444151482f4d42304741315564446751574242546f0a35486142784b46476b6f74556857527161674f734b434a424b7a423742674e56485245456444427967674e4f52302b4343577876593246736147397a644949440a546b64506767787762327868636931754d53314f52302b4346476876633351755a47396a613256794c6d6c7564475679626d467367675231626d6c34676770310a626d6c346347466a613256306767646964575a6a623235756877522f4141414268784141414141414141414141414141414141414141414268775373456741430a4d416f4743437147534d343942414d43413063414d45514349426a7967717a5a36514d653274775a3637364c33594e756c774858396345354a796e63506138370a5174584841694254776c42534b2b304953683034644c5a43353369593435423850795a74744e7a38796f616248524b7854773d3d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a';
const macaroonHex = '0201036c6e6402f801030a10779f751e35b214bf9ebe2646573623221201301a160a0761646472657373120472656164120577726974651a130a04696e666f120472656164120577726974651a170a08696e766f69636573120472656164120577726974651a210a086d616361726f6f6e120867656e6572617465120472656164120577726974651a160a076d657373616765120472656164120577726974651a170a086f6666636861696e120472656164120577726974651a160a076f6e636861696e120472656164120577726974651a140a057065657273120472656164120577726974651a180a067369676e6572120867656e657261746512047265616400000620cb82629478259fe842b982844a7e460df4acf7c20fa07b3491d0620bb61c0de8';

const configDir = path.join(__dirname, 'backend', 'config');

// Ensure directory exists
if (!fs.existsSync(configDir)) {
    fs.mkdirSync(configDir, { recursive: true });
}

// Write TLS Cert
const tlsBuffer = Buffer.from(tlsHex, 'hex');
fs.writeFileSync(path.join(configDir, 'tls.cert'), tlsBuffer);
console.log('✅ Updated tls.cert');

// Write Macaroon
const macaroonBuffer = Buffer.from(macaroonHex, 'hex');
fs.writeFileSync(path.join(configDir, 'admin.macaroon'), macaroonBuffer);
console.log('✅ Updated admin.macaroon');
